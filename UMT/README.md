# UMTScore and FVD-UMT
This repo describes how to evaluate a text-to-video (T2V) generation model on the [FETV](https://github.com/llyx97/FETV) benchmark using UMTScore and UMT-FVD.

## Installation
Please follow the installation instructions in [INSTALL](./INSTALL.md).

## Prepare Videos for Evaluation
The generated videos should be named corresponding to the prompt ID in FETV and placed in the same folder, which is structured as follows:
```
../datas/videos/t2v_modelname
├── 0.mp4
├── 1.mp4
...
├── 617.mp4
└── 618.mp4
```
The videos can be either `.mp4` or `.gif` format.  

(ignore this if you only want to evaluate the generated videos) The ground-truth reference videos should be named according to the video IDs in FETV and structured as follows:
```
../datas/videos/real_videos
├── video9033.mp4
├── video9376.mp4
...
├── 1058614837.mp4
└── 1063082371.mp4
```

## Prepare UMT Model
We fine-tune the UMT model for video-text retrieval on the 7k training split of MSR-VTT. Download the model checkpoint `ckpt_best.pth` from this [link](https://huggingface.co/lyx97/UMT-msrvtt-7k) and place it into `ckpts/umt_msrvtt_7k`.

## UMTScore
The scripts to evaluate CogVideo, Text2Video-zero, ModelScope-T2V, ZeroScope and reference videos can be found in `exp/t2v_eval`.  
Run `bash exp/t2v_eval/t2v_eval_modelscope_t2v.sh` to evaluate videos generated by ModelScope-T2V. To evaluate a new T2V generation model, modify the following parameters:
* JOB_NAME in `exp/t2v_eval/t2v_eval_modelscope_t2v.sh` that defines the output folder.
* test_file in `exp/t2v_eval/configs/modelscope_t2v_config.py` that defines the annotation file and path of generated videos.

## FVD-UMT
### Extract UMT Video Features
To extract UMT video features for ModelScope-T2V (change the script to evaluate different models), run
```
bash exp/t2v_eval/feature_extract_modelscope-t2v.sh
```
The extracted features will be saved to `../datas/videos/modelscope-t2v_feats`.

### Compute FVD-UMT
- The scripts to compute FVD-UMT can be found in `../stylegan-v`. Enter the folder and run `bash run_fvd_modelscope-t2v.sh` to evaluate videos generated by ModelScope-T2V (change the script to evaluate different models). The results will be saved to `../auto_eval_results/fvd_umt_results`.
- To compute FVD-UMT of different categories, run:
  ```
  python compute_fvd_umt_multi_aspect.py \
      --model modelscope-t2v 
  ```
  The results will be saved to `../auto_eval_results/fvd_umt_fg_results`.
